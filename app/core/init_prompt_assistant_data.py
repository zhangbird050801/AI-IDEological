"""
初始化提示词助手数据
"""

import asyncio
from app.models.ideological import PromptAssistantTemplate
from tortoise import Tortoise
from app.core.init_app import init_db


async def init_prompt_assistant_templates():
    """初始化提示词助手模板"""

    templates_data = [
        {
            "name": "写作助手",
            "description": "帮助用户制作各种类型文章写作的提示词，包括博客、论文、报告等",
            "template_type": "writing",
            "target_audience": "内容创作者、学生、职场人士",
            "use_case_scenario": "当用户需要AI帮助撰写或优化各种类型的文章内容时使用",
            "sample_prompts": [
                "你是一个专业的内容创作者，擅长写作高质量的文章。请根据以下要求创作内容：",
                "你是一个经验丰富的写作助手，能够帮助用户改进和完善他们的写作作品。",
                "你是一个专业的编辑，擅长提升文章质量、结构优化和语言润色。"
            ],
            "key_questions": [
                "你希望创作什么类型的文章？（博客、学术论文、工作报告、创意故事等）",
                "文章的目标读者是谁？（专业人士、普通大众、学生、同事等）",
                "你希望文章采用什么样的风格和语调？（正式、轻松、专业、友好等）",
                "文章大概需要多长？（字数或段落要求）",
                "有什么特定的话题或主题吗？",
                "需要包含哪些关键信息或观点？",
                "有什么特殊要求或限制吗？"
            ],
            "best_practices": [
                "明确说明文章的类型和目的",
                "指定目标受众以调整语言风格",
                "提供具体的话题或主题信息",
                "说明期望的文章长度和结构",
                "如果有参考资料，请提供相关背景",
                "明确要求不包含某些敏感或不适当的内容"
            ],
            "common_variables": ["文章类型", "目标读者", "风格语调", "长度要求", "主题话题", "关键要点"]
        },
        {
            "name": "代码助手",
            "description": "帮助开发者制作编程相关的提示词，包括代码生成、调试、优化等",
            "template_type": "coding",
            "target_audience": "程序员、开发者、计算机专业学生",
            "use_case_scenario": "当用户需要AI帮助解决编程问题、生成代码或进行代码审查时使用",
            "sample_prompts": [
                "你是一个经验丰富的程序员，精通多种编程语言和开发框架。请帮助解决以下编程问题：",
                "你是一个代码审查专家，擅长发现代码中的问题并提供改进建议。",
                "你是一个全栈开发工程师，能够帮助完成从前端到后端的开发任务。"
            ],
            "key_questions": [
                "使用什么编程语言？（Python、JavaScript、Java、C++等）",
                "你希望实现什么功能或解决什么问题？",
                "这是一个新项目还是现有项目的修改？",
                "有什么特定的技术栈或框架要求吗？",
                "对代码质量有什么要求？（性能、安全性、可读性等）",
                "有什么编码规范或最佳实践需要遵循？",
                "需要注释或文档吗？"
            ],
            "best_practices": [
                "明确说明编程语言和版本",
                "详细描述要实现的功能需求",
                "提供相关的上下文信息",
                "说明性能和安全要求",
                "指定编码规范和风格要求",
                "如果涉及第三方库，请列出相关信息"
            ],
            "common_variables": ["编程语言", "功能需求", "技术栈", "性能要求", "编码规范", "项目背景"]
        },
        {
            "name": "学习助手",
            "description": "帮助学生和自学者制作学习相关的提示词，包括知识讲解、学习计划、考试准备等",
            "template_type": "learning",
            "target_audience": "学生、自学者、教育培训工作者",
            "use_case_scenario": "当用户需要AI帮助进行学习规划、知识理解或备考准备时使用",
            "sample_prompts": [
                "你是一个专业的学习导师，擅长制定个性化学习计划和解释复杂概念。",
                "你是一个经验丰富的教师，能够用简单易懂的方式解释各种知识点。",
                "你是一个学习策略专家，帮助学生高效掌握新知识和技能。"
            ],
            "key_questions": [
                "你想学习什么学科或技能？",
                "你目前的学习基础如何？（初学者、中级、高级）",
                "你的学习目标是什么？（掌握基础、通过考试、应用实践等）",
                "有多长时间可以用于学习？",
                "你偏好的学习方式是什么？（视觉、听觉、实践等）",
                "有什么特定的学习难点需要重点解决吗？",
                "需要准备考试吗？如果是，什么类型的考试？"
            ],
            "best_practices": [
                "明确说明学习目标和水平",
                "提供充足的学习时间信息",
                "描述学习偏好和困难点",
                "如果是为了考试，说明考试类型和要求",
                "要求分步骤或分阶段的学习计划",
                "可以要求包含练习题或测试"
            ],
            "common_variables": ["学习科目", "当前水平", "学习目标", "时间安排", "学习方式", "考试要求"]
        },
        {
            "name": "创意助手",
            "description": "帮助创意工作者制作创意相关的提示词，包括故事创作、设计灵感、营销文案等",
            "template_type": "creative",
            "target_audience": "创意工作者、营销人员、内容创作者、设计师",
            "use_case_scenario": "当用户需要AI帮助产生创意内容、进行头脑风暴或创作时使用",
            "sample_prompts": [
                "你是一个富有创意的助手，擅长产生新颖的想法和创意内容。",
                "你是一个专业的创意总监，能够提供独特的设计和营销思路。",
                "你是一个故事创作专家，能够创作引人入胜的情节和角色。"
            ],
            "key_questions": [
                "你需要什么类型的创意内容？（故事、设计、文案、想法等）",
                "这个创意的用途是什么？（商业、个人、艺术等）",
                "目标受众是谁？",
                "有什么特定的主题或风格偏好吗？",
                "希望传达什么核心信息或情感？",
                "有什么限制条件或约束吗？",
                "需要多少个创意选项？"
            ],
            "best_practices": [
                "明确说明创意类型和用途",
                "描述目标受众和期望效果",
                "提供主题和风格指导",
                "说明任何限制或约束条件",
                "可以要求多个创意选项供选择",
                "鼓励创新和独特性"
            ],
            "common_variables": ["创意类型", "目标受众", "核心主题", "风格偏好", "使用场景", "约束条件"]
        },
        {
            "name": "分析助手",
            "description": "帮助用户制作数据分析、问题分析、决策支持相关的提示词",
            "template_type": "analysis",
            "target_audience": "分析师、管理者、研究员、决策者",
            "use_case_scenario": "当用户需要AI帮助进行数据分析、问题诊断或制定决策时使用",
            "sample_prompts": [
                "你是一个专业的数据分析师，擅长从数据中发现洞察并提供 actionable 的建议。",
                "你是一个问题解决专家，能够系统性分析复杂问题并提供解决方案。",
                "你是一个战略顾问，能够基于信息分析帮助制定明智的决策。"
            ],
            "key_questions": [
                "你需要分析什么类型的数据或问题？",
                "分析的目标是什么？（发现问题、寻找机会、支持决策等）",
                "有什么特定的分析维度或标准吗？",
                "你的角色或立场是什么？（管理者、分析师、研究者等）",
                "有什么时间限制或紧急性吗？",
                "需要什么形式的输出？（报告、建议、图表等）",
                "有什么已知的相关信息或背景吗？"
            ],
            "best_practices": [
                "明确说明分析对象和目标",
                "提供相关的背景信息",
                "指定分析框架或标准",
                "说明输出格式和详细程度",
                "如果有时间敏感性，请明确说明",
                "要求提供基于证据的结论"
            ],
            "common_variables": ["分析对象", "分析目标", "分析维度", "角色立场", "输出要求", "时间限制"]
        },
        {
            "name": "翻译助手",
            "description": "帮助用户制作高质量的翻译提示词，支持多语言翻译和本地化",
            "template_type": "translation",
            "target_audience": "翻译工作者、国际交流人员、多语言内容创作者",
            "use_case_scenario": "当用户需要进行专业的翻译或多语言内容转换时使用",
            "sample_prompts": [
                "你是一个专业的翻译专家，精通多语言翻译，能够保持原文的意思和语调。",
                "你是一个本地化专家，不仅翻译文字，还考虑文化差异和本地习惯。",
                "你是一个技术翻译专员，擅长准确翻译技术文档和专业术语。"
            ],
            "key_questions": [
                "源语言和目标语言是什么？",
                "原文或原文的大概内容是什么？",
                "文本的类型是什么？（技术文档、营销文案、正式信函、日常对话等）",
                "目标读者是谁？（专业人士、普通大众、特定群体等）",
                "对翻译风格有什么要求？（正式、非正式、技术性、文学性等）",
                "需要保持特定的格式或排版吗？",
                "有什么需要特别注意的文化或语言细节吗？"
            ],
            "best_practices": [
                "明确说明源语言和目标语言",
                "描述文本类型和语境",
                "说明目标读者的背景",
                "指定翻译的风格和语调要求",
                "如果有特定术语，请提供词汇表",
                "注意文化和地区差异"
            ],
            "common_variables": ["源语言", "目标语言", "文本类型", "目标读者", "翻译风格", "专业术语"]
        }
    ]

    # 检查是否已存在模板
    existing_count = await PromptAssistantTemplate.filter().count()

    if existing_count > 0:
        print(f"提示词助手模板已存在 ({existing_count} 个)，跳过初始化")
        return

    # 创建模板
    created_count = 0
    for template_data in templates_data:
        try:
            await PromptAssistantTemplate.create(**template_data)
            created_count += 1
            print(f"已创建提示词助手模板: {template_data['name']}")
        except Exception as e:
            print(f"创建模板失败 {template_data['name']}: {str(e)}")

    print(f"\n提示词助手模板初始化完成，共创建 {created_count} 个模板")


async def main():
    """主函数"""
    # 初始化数据库连接
    await init_db()

    try:
        # 初始化提示词助手模板
        await init_prompt_assistant_templates()
        print("\n✅ 提示词助手数据初始化成功完成!")
    except Exception as e:
        print(f"\n❌ 提示词助手数据初始化失败: {str(e)}")
        raise
    finally:
        # 关闭数据库连接
        await Tortoise.close_connections()


if __name__ == "__main__":
    asyncio.run(main())